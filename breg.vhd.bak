library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity breg is
generic (WSIZE : natural := 32);
port (
	clk, wren : in std_logic;
	radd1, radd2, wadd : in std_logic_vector(4 downto 0);
	wdata : in std_logic_vector(WSIZE-1 downto 0);
	r1, r2 : out std_logic_vector(WSIZE-1 downto 0));
end breg;

architecture breg_arch of breg is

type breg is array(0 to 31) of std_logic_vector(31 downto 0);
signal registers : breg;
begin
  breg_process : process (clk) is
  begin
    if rising_edge(clk) then
		registers(0) <= "00000000000000000000000000000000";
      -- Verifica se escrita estÃ¡ habilitada
      if (wren = '1' and (unsigned(wadd) /= "00000") ) then
        registers(to_integer(unsigned(wadd))) <= wdata;
      end if;
      -- Realiza a leitura de A e B
      r1 <= registers(to_integer(unsigned(radd1)));
      r2 <= registers(to_integer(unsigned(radd2)));
    end if;
  end process;
end breg_arch;
